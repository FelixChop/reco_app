<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8" />
    <title>Machine Learning Recommendation app</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="style.css" />
</head>

<body>
    <div class="app-container">
        <header class="app-header">
            <h1>Machine Learning Recommendation app</h1>
        </header>

        <div class="mode-selector" id="modeSelector">
            <div class="mode-selector-header">
                <button
                    id="modeToggle"
                    class="mode-toggle"
                    type="button"
                    aria-expanded="false"
                    aria-controls="modeTabsWrapper"
                >
                    <span class="mode-toggle-icon" aria-hidden="true"></span>
                    <span class="sr-only">Ouvrir le sélecteur de mode</span>
                </button>
                <span class="mode-label">Mode :</span>
            </div>

            <div class="mode-tabs-wrapper" id="modeTabsWrapper">
                <div class="mode-tabs" id="modeTabs"></div>
            </div>
        </div>

        <!-- STEP 1: rating 3 colors -->
        <section id="rating-section" class="card active">
            <button id="getRecsButton" class="btn-primary" disabled>
                Obtenir mes recommandations
            </button>

            <div id="color-card" class="color-card">
                <div id="color-swatch" class="color-swatch"></div>
                <div id="color-name" class="color-name"></div>
                <div class="stars" id="star-container">
                    <!-- stars generated by JS -->
                </div>
            </div>

            <div class="rating-actions">
                <div id="ratingHint" class="hint">Clique sur une étoile entre 1 et 5.</div>
                <button id="skipButton" class="btn-secondary">Passer</button>
            </div>

        </section>

        <!-- STEP 2: loading animation -->
        <div id="trainingOverlay" class="overlay hidden">
            <div class="overlay-card">
                <div class="spinner"></div>
                <h3>Calcul des recommandations…</h3>
                <p id="trainingStats"></p>
                <ul id="algoList" class="algo-list"></ul>
                <p class="hint-text">
                    Méthodo ML : train/test split 80/20, grid search sur plusieurs algorithmes,
                    sélection du meilleur modèle sur le RMSE.
                </p>
            </div>
        </div>


        <!-- STEP 3: predictions -->
        <section id="predictions-section" class="card hidden">

            <button id="showModelsButton" class="btn-secondary">
                Voir les modèles de ML
            </button>


            <button id="refreshRecsButton" class="btn-primary-outline hidden">
                Actualiser les recommandations
            </button>
            <div id="recsGrid" class="recs-grid"></div>


            <div class="predictions-controls">
                <label for="sort-order">Trier par note prédite :</label>
                <select id="sort-order">
                    <option value="desc">Plus haute → Plus basse</option>
                    <option value="asc">Plus basse → Plus haute</option>
                </select>
            </div>

            <div id="predictions-list" class="predictions-list">
                <!-- JS -->
            </div>

            <button id="to-diagnostics" class="btn-secondary">
                Voir les modèles de ML
            </button>
        </section>

        <!-- STEP 4: diagnostics -->

        <div id="modelsPanel" class="models-panel hidden">
            <h3>Leaderboard des modèles</h3>
            <table id="modelsTable">
                <thead>
                    <tr>
                        <th>Modèle</th>
                        <th>RMSE global</th>
                        <th>RMSE pour toi</th>
                        <th>Rang</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>


        <section id="diagnostics-section" class="card hidden">
            <h2>Diagnostic des modèles</h2>

            <h3>Leaderboard des modèles</h3>
            <table class="leaderboard">
                <thead>
                    <tr>
                        <th>Modèle</th>
                        <th>RMSE</th>
                        <th>Rang</th>
                    </tr>
                </thead>
                <tbody id="leaderboard-body">
                </tbody>
            </table>

            <p id="best-model-summary" class="best-model-summary"></p>

            <h3>Matrice de confusion (meilleur modèle)</h3>
            <p class="confusion-hint">
                Lignes = note réelle · Colonnes = note prédite (arrondies de 1 à 5)
            </p>
            <table class="confusion-table">
                <thead>
                    <tr>
                        <th>Réel \ Prédit</th>
                        <th>1</th>
                        <th>2</th>
                        <th>3</th>
                        <th>4</th>
                        <th>5</th>
                    </tr>
                </thead>
                <tbody id="confusion-body">
                </tbody>
            </table>

            <button id="restart" class="btn-primary">
                Recommencer avec 3 nouvelles couleurs
            </button>
        </section>
    </div>

    <script src="app.js"></script>
</body>

</html>
