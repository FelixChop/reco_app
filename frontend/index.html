<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8" />
    <title>Machine Learning Recommendation app</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="style.css" />
</head>

<body>
    <div class="app-container">
        <header class="app-header">
            <h1>Machine Learning Recommendation app</h1>
        </header>

        <div class="main-toolbar" id="mainToolbar">
            <div class="toolbar-left">
                <!-- Mobile Trigger -->
                <button id="mobileModeTrigger" class="mode-mobile-trigger hidden-desktop">
                    <span id="mobileModeLabel">Politiques françaises</span>
                    <span class="arrow">▼</span>
                </button>

                <!-- Desktop Tabs -->
                <div id="desktopModeTabs" class="mode-tabs-desktop hidden-mobile">
                    <!-- Tabs injected by JS -->
                </div>
            </div>

            <div class="toolbar-right">
                <span id="voterCount" class="voter-count"></span>

                <div id="predictionControls" class="prediction-controls hidden">
                    <button id="similarUsersBtn" class="btn-primary btn-similar"
                        title="Voir les utilisateurs similaires">
                        Utilisateurs similaires
                    </button>
                    <button id="mlInfoBtn" class="btn-primary btn-algo" title="Voir les algorithmes">
                        Algorithmes de recommandation
                    </button>
                    <button id="sortBtn" class="icon-btn" title="Trier">
                        <img src="assets/sort-icon.png" alt="Trier" class="icon-img">
                    </button>
                    <button id="viewToggleBtn" class="icon-btn" title="Changer l'affichage">
                        <img src="assets/view-icon.png" alt="Vue" class="icon-img">
                    </button>
                </div>
            </div>
        </div>

        <!-- STEP 1: rating 3 colors -->
        <section id="rating-section" class="card active">
            <div id="color-card" class="color-card">
                <div class="color-layout">
                    <div class="image-container">
                        <div id="color-swatch" class="color-swatch"></div>
                        <!-- Spotify Player Container -->
                        <div id="spotifyPlayer" class="spotify-player hidden"></div>
                    </div>
                    <div class="color-details">
                        <h2 id="itemName" class="color-name">Nom de l'item</h2>
                        <p id="itemSubtitle" class="item-subtitle">Sous-titre</p>
                        <div class="rating-row">
                            <div class="stars" id="star-container">
                                <!-- stars generated by JS -->
                            </div>
                            <button id="skipButton" class="btn-secondary btn-sm">Passer</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="cta-container">
                <button id="getRecsButton" class="btn-primary hidden-magic" disabled
                    aria-label="Calculer mes affinités">
                    <span class="button-text">Calculer mes affinités</span>
                    <span id="ctaStatus" class="sr-only" aria-live="polite"></span>
                </button>
            </div>

        </section>

        <!-- STEP 2: loading animation -->
        <div id="trainingOverlay" class="overlay hidden">
            <div class="overlay-card">
                <div class="spinner"></div>
                <h3>Calcul des recommandations…</h3>
                <div id="trainingSteps" class="training-steps"></div>
            </div>
        </div>


        <!-- STEP 3: predictions -->
        <section id="predictions-section" class="card hidden">
            <div id="recsGrid" class="recs-grid"></div>
        </section>

        <!-- STEP 4: diagnostics (Modal) -->
        <div id="diagnostics-modal" class="overlay hidden">
            <div class="overlay-card diagnostics-card">
                <button id="closeDiagnostics" class="close-btn">×</button>
                <h2>Diagnostic des modèles</h2>

                <h3>Leaderboard des modèles</h3>
                <table class="leaderboard data-table">
                    <thead>
                        <tr>
                            <th>Rang</th>
                            <th>Modèle</th>
                            <th>RMSE</th>
                            <th>MAE</th>
                            <th>FCP</th>
                        </tr>
                    </thead>
                    <tbody id="leaderboard-body">
                    </tbody>
                </table>

                <p id="best-model-summary" class="best-model-summary"></p>
                <div id="best-model-params" class="model-params"></div>

                <h3>Matrice de confusion (meilleur modèle)</h3>
                <p class="confusion-hint">
                    Lignes = note réelle · Colonnes = note prédite (arrondies de 1 à 5)
                </p>
                <table class="confusion-table data-table">
                    <thead>
                        <tr>
                            <th>Réel \ Prédit</th>
                            <th>1</th>
                            <th>2</th>
                            <th>3</th>
                            <th>4</th>
                            <th>5</th>
                        </tr>
                    </thead>
                    <tbody id="confusion-body">
                    </tbody>
                </table>
            </div>
        </div>

    </div>

    <!-- Mobile Mode Selection Overlay -->
    <div id="mobileModeOverlay" class="mode-mobile-overlay hidden">
        <div class="mobile-overlay-header">
            <h2>Choisir une thématique</h2>
            <button id="closeMobileOverlay" class="close-btn-overlay">×</button>
        </div>
        <div id="mobileModeList" class="mobile-mode-list">
            <!-- Items injected by JS -->
        </div>
    </div>

    <script src="app.js"></script>
</body>

</html>